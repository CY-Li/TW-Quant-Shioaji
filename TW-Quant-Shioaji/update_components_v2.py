import json

def update_components():
    # 0050 大型權值 (剔除金融 28xx, 58xx)
    ft50_no_fin = [
        "2330", "2317", "2454", "2308", "2303", "3711", "2412", "1301", "1303", "1216", 
        "2002", "2357", "2382", "2301", "2395", "3008", "2409", "2603", "3045", "6505"
    ]
    
    # 0051 中型股代表 (剔除金融，增加具備波動性與技術反轉特性的標的)
    ft100_no_fin = [
        "2609", "2615", "2324", "3231", "2356", "2376", "2377", "2408", "3481", "2448",
        "3034", "3035", "3037", "8046", "2498", "2345", "6239", "2313", "2360", "2409",
        "1476", "9910", "2105", "1101", "2014", "2610", "2618", "1605", "1319", "1722",
        "1504", "1513", "1519", "1717", "1723", "2352", "2353", "2368", "2474", "2492"
    ]
    
    # 合併並去重
    all_symbols = sorted(list(set(ft50_no_fin + ft100_no_fin)))
    
    # 二次確認過濾金融股 (以防萬一)
    all_symbols = [s for s in all_symbols if not (s.startswith('28') or s.startswith('58'))]
    
    with open("TW-Quant-Shioaji/components.json", "w") as f:
        json.dump(all_symbols, f)
    
    return all_symbols

if __name__ == "__main__":
    new_list = update_components()
    print(f"成功更新清單！目前共計 {len(new_list)} 支標的 (已過濾金融股，包含 0051 中型股)")
    print(f"清單範例: {new_list[:15]}...")
